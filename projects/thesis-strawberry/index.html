<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thesis Summary · Exploring Unsupervised Autoencoders for Early Disease Detection</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      /* bumped contrast for clearer text */
      --bg:#0b0c10; --text:#f2f4f7; --muted:#b6bac5; --panel:#171a1f; --accent:#59d;
    }
    html,body{margin:0}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.6}

    /* FULL-WIDTH LAYOUT */
    .wrap{width:100%; max-width:none; margin:0; padding:0}
    header{display:grid;gap:.5rem; padding:clamp(1rem,3vw,2rem); text-align: center;}
    h1{font-size:clamp(1.5rem,3.5vw,2.2rem);line-height:1.1;margin:0}
    .lead{color:var(--muted);margin:0}

    /* Main content box: more side padding + clearer box styling */
    .panel{
      background:var(--panel);
      border:1px solid #262a35;
      border-radius:16px;
      padding:clamp(1.5rem,6vw,4rem);   /* ← more left/right padding */
      box-shadow:0 10px 28px rgba(0,0,0,.35);
    }

    /* Grid stays full-width */
    .grid{display:grid;gap:clamp(.75rem,2vw,1.25rem)}
    /* 1) Use a single column (no empty right column) */
    @media (min-width:1000px){
      .grid{ grid-template-columns: minmax(0, 1fr); }
    }

    /* 2) Center the whole content box and cap its width */
    .panel{
      max-width: 1100px;           /* pick any cap you like */
      margin-left: auto;
      margin-right: auto;          /* centers the box */
      /* keep your existing padding/border/shadow as-is */
    }

    h2{font-size:1.1rem;margin:.25rem 0 .5rem}
    ul{margin:.25rem 0 0 1.1rem}
    li{margin:.25rem 0}
    .kbd{font-weight:600}
    .muted{color:var(--muted)}

    /* Figures adapt to image size (no cropping) */
    figure{
      margin:clamp(.75rem,2vw,1rem) 0;
      background:#0f1117;
      border:1px solid #1c1f27;
      border-radius:12px;
      overflow:hidden;
    }
    /* stop forcing full width, so small utilities can take effect */
    figure img{
      display:block;
      width:auto;
      height:auto;
      max-width:100%;
      margin:0 auto;     /* center inside figure */
    }
    figcaption{font-size:.9rem;color:var(--muted);padding:.5rem .75rem}

    /* Small image utility: cap to ~80×80, keep aspect ratio, no crop */
    img.thumb-20{
      width:auto;
      height:auto;
      max-width:80px;    /* change to 60px/100px as you like */
      max-height:80px;
      display:block;
      margin:0 auto;
    }

    .cta{
      display:inline-block;margin-top:.75rem;text-decoration:none;color:#000;
      background:var(--accent);padding:.6rem .9rem;border-radius:999px;font-weight:700
    }
    footer{padding:clamp(1rem,3vw,2rem);font-size:.9rem;color:var(--muted)}
    .source{display:block;margin-top:.5rem;font-size:.85rem;color:var(--muted)}
  </style>
</head>
<body>
<header class="site-header">
<nav class="nav">
  <a class="brand" href="./">Leon Weiser</a>
  <div class="links">
    <a href="https://leowiser.github.io/website_demo/#panel-projects">About</a>
    <a href="#panel-projects">Projects</a>
    <a href="https://github.com/Leowiser">GitHub</a>
  </div>
</nav>

  <!-- hero gets an id for JS -->
<section class="wrap" id="wrap">
    <h1>Exploring Fully Unsupervised Autoencoders for Early Disease Detection</h1>
      <p class="lead">Hyperspectral imaging of strawberry leaves to detect <em>P. cactorum</em>—no labels, 
        anomaly detection via reconstruction error.</p>
      <p class="lead">Code found on GitHub here: <a href="https://github.com/Leowiser/Thesis_Strawberries">https://github.com/Leowiser/Thesis_Strawberries</a>.</p>
</section>
</header>

    <div class="grid">
      <section class="panel">
        <h2>Core Idea</h2>
        <ul>
          <li>Use hyperspectral images (≈398–1000&nbsp;nm) of strawberry leaves; train only on healthy leaves; flag anomalies via reconstruction errors from convolutional autoencoders (2D &amp; 3D).</li>
        </ul>
        <figure class="figure-snug">
          <img class="thumb-20" src="../../assets/img/thesis/Cropped_preprocess.png" alt="Hyperspectral plant to leaf example">
          <figcaption>Cropped leaves from plant image.</figcaption>
        </figure>
        <figure class="figure-snug">
          <img class="thumb-20" src="../../assets/img/thesis/HSI_example.png" alt="Hyperspectral image and spectra">
          <figcaption>Example of hyperspectral leaf image and its spectra.</figcaption>
        </figure>

        <h2>Data &amp; Preprocessing</h2>
        <ul>
          <li>20 plants imaged daily (~2 weeks), cropped to leaves; 388 samples (321 healthy / 67 infected).</li>
          <li>Preprocessing: mask background; remove noisy bands (&lt;430&nbsp;nm); SNV normalization; PCA-guided band selection to 17 wavelengths (also compared with full spectrum).</li>
        </ul>
        <figure class="figure-snug">
          <img class="thumb-20" src="../../assets/img/thesis/Mask_preprocess.png" alt="Masked image example">
          <figcaption>Masked image.</figcaption>
        </figure>
        <figure class="figure-snug">
          <img class="thumb-20" src="../../assets/img/thesis/PCA_bandselect.png" alt="Hyperspectral plant to leaf example">
          <figcaption>Selected bands based on PCA loadings and spectral data exploration.</figcaption>
        </figure>

        <h2>Method</h2>
        <ul>
          <li>Train <strong>3D Convolutional Autoencoder</strong> on healthy leaves; evaluate infection by image-level reconstruction error with thresholds; metrics: ROC-AUC, PR-AUC, FPR@95%TPR.</li>
          <li>Error-mitigation steps: remove edge artifacts, apply masks post-recon, prefer SNV to reduce illumination scatter.</li>
          <li>Experimented with alternative error metrics (e.g., per-band extreme-pixel rate; vein-focused errors; latent-space similarity).</li>
        </ul>
        <figure class="figure-snug">
          <img class="thumb-20" src="../../assets/img/thesis/Vis_3DCNN.png" alt="Vis of 3DCAE">
          <figcaption>Visualization of 3D Convolutional Autoencoder.</figcaption>
        </figure>
        <figure class="figure-snug">
          <img class="thumb-20" src="../../assets/img/thesis/Recon_Error_Max.png" alt="Reconstruction error">
          <figcaption>Examplary leaf with reconstruction and mean absolute reconstruction error.</figcaption>
        </figure>

        <h4>Alternative Error Metrics</h4>
        <ul>
          <li>Latent space similarity based on <a href="https://link.springer.com/article/10.1186/s13362-023-00133-6">Benfenati et al. (2023)</a>.</li>
          <li>Per-band extreme-error pixel: Own idea, using the rate of all pixels with error values above the 99&percnt; quantile of the validation set (only healthy leaves) over all pixels to identify diseases.</li>
          <li>Vein-focused errors: Original idea based on the disease spread in the plant, as it often progresses through the veins. Veins and proximate areas are identified using the highest eigenvalues. The mean absolute error of the found area is taken.</li>
        </ul>
        <figure class="figure-snug">
          <img class="thumb-20" src="../../assets/img/thesis/Pixel_errors_99quant.png" alt="Extreme pixel error">
          <figcaption>Extreme-error pixels of leaves at different stages of infection and different bands. Pixels with errors above 99&percnt; are coloured red.</figcaption>
        </figure>
        <figure class="figure-snug">
          <img class="thumb-20" src="../../assets/img/thesis/Vein_Error.png" alt="Vein error">
          <figcaption>Identified veins and the error in that area for different stages of infection.</figcaption>
        </figure>

        <h2>Key Findings</h2>
        <ul>
          <li>Fully unsupervised CAEs struggled to cleanly separate healthy vs infected leaves—especially in early stages; best conventional setup reached modest ROC-AUC, and 3D did not clearly outperform 2D.</li>
          <li>“Extreme-pixel” per-band metric showed most promise for day-1 infections (lowest FPR@95%TPR among tested metrics), but overall accuracy remained limited.</li>
          <li>Reduced 17-band sets performed comparably to the full spectrum → careful band selection can cut complexity without large losses.</li>
        </ul>

        <h2>Takeaways</h2>
        <ul>
          <li>Symptoms of <em>P. cactorum</em> resemble benign variation (e.g., drought stress), making purely unsupervised detection intrinsically hard on this dataset.</li>
          <li>Pipeline + preprocessing + error-metric ideas form a reusable baseline for future semi-supervised or hybrid approaches.</li>
        </ul>

        <a class="cta" href="../../Master_Thesis-13.pdf">Read full thesis (PDF)</a>
        <small class="source">Summary based on the authors’ master’s thesis.</small>
      </section>
    </div>

    <footer>
      © <span id="year"></span> Leon Weiser • KU Leuven
    </footer>
  </div>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
